# Тестирование: Dynamic Layout (0007)

**Спецификация:** [docs/specs/0007-feat-dynamic-layout.md](../specs/0007-feat-dynamic-layout.md)
**Дата:** 2026-02-21

---

## Happy Path

### Сценарий 1 — Базовое поведение по умолчанию

**Шаги:**
1. [ ] Открыть плагин с чистым `data.json` (или удалить старый) → focus и inProgress стоят рядом (50%/50%), остальные на полную ширину
2. [ ] Открыть настройки доски → во вкладке групп видны два checkbox на каждую строку: «Видимость» и «Полная ширина»
3. [ ] Checkbox «Полная ширина» у focus и inProgress — **снят** (false), у остальных — **установлен** (true)

### Сценарий 2 — Переключить focus в full → inProgress одиночка

**Шаги:**
1. [ ] Открыть настройки доски
2. [ ] Установить «Полная ширина» для focus → сохранить
3. [ ] focus занимает всю ширину
4. [ ] inProgress (half, без пары) → растягивается на всю ширину (`--half-alone`)

### Сценарий 3 — orgIntentions в half → встаёт рядом с delegated

**Шаги:**
1. [ ] Открыть настройки доски
2. [ ] Снять «Полная ширина» для orgIntentions
3. [ ] Снять «Полная ширина» для delegated → сохранить
4. [ ] orgIntentions и delegated стоят рядом (50%/50%)

### Сценарий 4 — Скрыть одного партнёра → оставшийся half растягивается

**Шаги:**
1. [ ] focus=half, inProgress=half
2. [ ] Открыть настройки → скрыть inProgress → сохранить
3. [ ] focus один с half — растягивается на полную ширину (`--half-alone`)

### Сценарий 5 — Три half подряд → пара + одиночка

**Шаги:**
1. [ ] Установить focus=half, inProgress=half, orgIntentions=half → сохранить
2. [ ] focus + inProgress стоят рядом (50%/50%)
3. [ ] orgIntentions один → растягивается на полную ширину

### Сценарий 6 — Настройки сохраняются после перезапуска

**Шаги:**
1. [ ] Изменить ширину нескольких групп → сохранить
2. [ ] Перезапустить Obsidian (или перезагрузить плагин)
3. [ ] Лейаут соответствует сохранённым настройкам

### Сценарий 7 — Создать новую доску → дефолты корректны

**Шаги:**
1. [ ] Нажать «+» (создать новую доску)
2. [ ] Открыть настройки новой доски
3. [ ] focus=false (half), inProgress=false (half), backlog/orgIntentions/delegated/completed=true (full)
4. [ ] Визуально: focus + inProgress рядом, остальные на всю ширину

### Сценарий 8 — Переключение между досками

**Шаги:**
1. [ ] Доска A: все группы full
2. [ ] Доска B: focus=half, inProgress=half
3. [ ] Переключиться A→B→A → лейаут каждый раз соответствует доске

---

## Edge Cases

### Сценарий 9 — Все 6 групп в half → 3 строки по 2 группы

**Шаги:**
1. [ ] Снять «Полная ширина» у всех 6 групп → сохранить
2. [ ] backlog+focus рядом, inProgress+orgIntentions рядом, delegated+completed рядом

### Сценарий 10 — [full, half, full, half] → оба half одиночки

**Шаги:**
1. [ ] backlog=full, focus=half, orgIntentions=full, delegated=half → сохранить
2. [ ] focus растягивается на всю ширину (`--half-alone`)
3. [ ] delegated растягивается на всю ширину (`--half-alone`)

### Сценарий 11 — Обе скрыты, одна включена → растягивается на full

**Шаги:**
1. [ ] Скрыть focus и inProgress
2. [ ] Включить только inProgress → сохранить
3. [ ] inProgress один с half → растягивается (`--half-alone`)

### Сценарий 12 — Обе скрыты, обе включены → встают парой

**Шаги:**
1. [ ] Скрыть focus и inProgress
2. [ ] Включить оба обратно → сохранить
3. [ ] focus + inProgress рядом (50%/50%)

### Сценарий 13 — Одна видимая группа (last visible)

**Шаги:**
1. [ ] Скрыть все группы кроме одной
2. [ ] Последняя видимая группа — checkbox «Видимость» disabled
3. [ ] Checkbox «Полная ширина» при этом **активен** (можно менять)
4. [ ] Группа с half → растягивается на полную ширину

### Сценарий 14 — backlog свёрнут + fullWidth:false → узкий заголовок 50%

**Шаги:**
1. [ ] Установить backlog=half → сохранить
2. [ ] backlog свёрнут (collapsed) → показывает только заголовок на 50% ширины
3. [ ] Это ожидаемое поведение, не баг

### Сценарий 15 — NotesSection всегда на полную ширину

**Шаги:**
1. [ ] Изменить любые настройки ширины групп → сохранить
2. [ ] NotesSection (заметки доски) всегда занимает всю ширину

---

## Миграция

### Сценарий 16 — Старый data.json (version=4) мигрирует корректно

**Шаги:**
1. [ ] Подготовить `data.json` с `version: 4` (без поля `fullWidth` в группах)
2. [ ] Загрузить плагин
3. [ ] `version` становится `5`
4. [ ] focus.fullWidth=false, inProgress.fullWidth=false
5. [ ] backlog/orgIntentions/delegated/completed.fullWidth=true
6. [ ] Визуальный лейаут не изменился по сравнению с pre-migration

### Сценарий 17 — Новый data.json (version=5) не перезаписывает данные

**Шаги:**
1. [ ] Установить кастомные значения fullWidth → сохранить (version=5)
2. [ ] Перезапустить плагин
3. [ ] Кастомные значения сохранились, не сброшены в дефолты

---

## UI — BoardSettingsPopup

### Сценарий 18 — Checkbox «Полная ширина» disabled для скрытой группы

**Шаги:**
1. [ ] Открыть настройки доски
2. [ ] Снять видимость у любой группы
3. [ ] Checkbox «Полная ширина» у скрытой группы — **disabled**
4. [ ] Нельзя менять fullWidth для скрытой группы

### Сценарий 19 — fullWidth скрытой группы сохраняется

**Шаги:**
1. [ ] Установить focus=half → сохранить
2. [ ] Скрыть focus → сохранить
3. [ ] Включить focus обратно → сохранить
4. [ ] focus=half (значение не сброшено)

### Сценарий 20 — Заголовки колонок отображаются

**Шаги:**
1. [ ] Открыть настройки доски
2. [ ] Над строками групп видны заголовки: «Видимость групп» и «Полная ширина»
3. [ ] EN: «Group Visibility» / «Full width»
4. [ ] RU: «Видимость групп» / «Полная ширина»

---

## Responsive

### Сценарий 21 — Узкий экран (<600px) → все группы на полную ширину

**Шаги:**
1. [ ] Уменьшить viewport браузера до <600px (через DevTools)
2. [ ] Все группы (включая half) занимают полную ширину
3. [ ] Media query `@media (max-width: 600px)` работает корректно

---

## Итог

**Статус:** ⏳ Ожидает тестирования

| Сценарий | Результат | Примечания |
|---|---|---|
| 1. Дефолтный лейаут | | |
| 2. focus → full, inProgress одиночка | | |
| 3. orgIntentions + delegated рядом | | |
| 4. Скрыть партнёра → half-alone | | |
| 5. Три half подряд | | |
| 6. Сохранение после перезапуска | | |
| 7. Новая доска — дефолты | | |
| 8. Переключение между досками | | |
| 9. Все 6 в half | | |
| 10. full-half-full-half | | |
| 11. Обе скрыты, одна включена | | |
| 12. Обе скрыты, обе включены | | |
| 13. Одна видимая группа | | |
| 14. Collapsed + half | | |
| 15. NotesSection полная ширина | | |
| 16. Миграция v4→v5 | | |
| 17. v5 не сбрасывает кастомные значения | | |
| 18. Checkbox disabled для скрытой | | |
| 19. fullWidth скрытой сохраняется | | |
| 20. Заголовки колонок | | |
| 21. Responsive <600px | | |
