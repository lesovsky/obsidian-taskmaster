# Локализация интерфейса (i18n)

---

# Часть 1: Продуктовая

## Что меняется для пользователя

- Поддержка двух языков интерфейса: **English** и **Русский**
- Язык определяется автоматически по настройке Obsidian (Settings → General → Language)
- Можно переключить вручную в настройках плагина (Settings → TaskMaster → Language)
- Переключение мгновенное — без перезагрузки

---

## Что переводится

Весь UI плагина (~66 строк):

| Категория | Примеры | Кол-во |
|-----------|---------|--------|
| Названия групп | Бэклог → Backlog, В работе → In Progress | 6 |
| Кнопки | Сохранить → Save, Отмена → Cancel, Удалить → Delete | 16 |
| Метки форм | Что нужно сделать → What needs to be done, Приоритет → Priority | 20 |
| Плейсхолдеры | Описание задачи → Task description, Исполнитель → Assignee | 8 |
| Тултипы | Добавить задачу → Add task, Настройки группы → Group settings | 8 |
| Подсказки пустых групп | контекстные подсказки для каждой из 6 групп | 6 |
| Тост-уведомления | Удалено: {имя} → Deleted: {name}, Отменить → Undo | 3 |
| Настройки плагина | Приоритет по умолчанию → Default priority | 5 |
| Приоритеты | Низкий/Средний/Высокий → Low/Medium/High | 3 |
| Статусы | Новая/В работе/Ожидание/Завершена → New/In Progress/Waiting/Completed | 4 |

## Что НЕ переводится

- **Пользовательские данные** — названия досок, тексты задач, имена исполнителей остаются на том языке, на котором были введены
- **Дефолтные названия** при создании новых сущностей определяются текущим языком интерфейса (EN: «New board», RU: «Новая доска»)
- **Имя плагина** — «TaskMaster» в названии вкладки, ribbon-иконке и Command Palette остаётся без перевода (это бренд)
- **Команда** — `Open TaskMaster board` в Command Palette остаётся на английском (стандарт Obsidian для команд плагинов)

---

## Настройка языка

В Settings → TaskMaster появляется новый параметр **Language** (первый в списке):

| Значение | Поведение |
|----------|-----------|
| **Auto** (по умолчанию) | Берёт язык из настроек Obsidian. Если `ru` — русский, иначе — английский |
| **English** | Интерфейс всегда на английском |
| **Русский** | Интерфейс всегда на русском |

При смене языка в настройках:
- Вся доска перерисовывается мгновенно
- Настройки плагина перерисовываются на новом языке
- Пользовательские данные не затрагиваются

---

## Таблицы переводов

### Названия групп

| Ключ | Русский | English |
|------|---------|---------|
| backlog | Бэклог | Backlog |
| focus | Фокус | Focus |
| inProgress | В работе | In Progress |
| orgIntentions | Орг. намерения | Org Intentions |
| delegated | Делегировано | Delegated |
| completed | Завершённые | Completed |

### Подсказки пустых групп

| Группа | Русский | English |
|--------|---------|---------|
| Backlog | Задачи на будущее. Складывайте сюда всё, что появляется на горизонте, но пока не готово к работе | Future tasks. Put here everything on the horizon that isn't ready to work on yet |
| Focus | Что сейчас требует вашего внимания? Перетащите сюда задачи, которые нельзя упускать из виду | What needs your attention right now? Drag tasks here that you can't lose sight of |
| In Progress | Чем вы занимаетесь прямо сейчас? Добавьте задачи, над которыми работаете лично | What are you working on right now? Add tasks you're personally handling |
| Org Intentions | Что запланировано на эту неделю? Разместите здесь цели, которые хотите закрыть до конца недели | What's planned for this week? Place goals here you want to close by end of week |
| Delegated | Что вы поручили другим? Добавьте задачи, переданные коллегам, чтобы не забыть проверить их статус | What have you assigned to others? Add delegated tasks to track their status |
| Completed | Пока пусто — завершённые задачи будут появляться здесь | Nothing here yet — completed tasks will appear here |

### Приоритеты и статусы

| Ключ | Русский | English |
|------|---------|---------|
| priority.low | Низкий | Low |
| priority.medium | Средний | Medium |
| priority.high | Высокий | High |
| status.new | Новая | New |
| status.inProgress | В работе | In Progress |
| status.waiting | Ожидание | Waiting |
| status.completed | Завершена | Completed |

### Форма задачи

| Элемент | Русский | English |
|---------|---------|---------|
| Заголовок (создание) | Новая задача | New Task |
| Заголовок (редактирование) | Редактировать задачу | Edit Task |
| Метка «Что» | Что нужно сделать * | What needs to be done * |
| Плейсхолдер «Что» | Описание задачи | Task description |
| Метка «Зачем» | Зачем | Why |
| Плейсхолдер «Зачем» | Цель задачи | Task objective |
| Метка «Кто» | Кто | Who |
| Плейсхолдер «Кто» | Исполнитель | Assignee |
| Метка «Когда» | Когда | When |
| Метка «Приоритет» | Приоритет | Priority |
| Метка «Статус» | Статус | Status |
| Создана | Создана: | Created: |
| Завершена | Завершена: | Completed: |
| Кнопка удаления | Удалить | Delete |
| Кнопка сохранения | Сохранить | Save |

### Кнопки и тултипы

| Элемент | Русский | English |
|---------|---------|---------|
| Тултип удаления карточки | Удалить задачу | Delete task |
| Тултип настроек группы | Настройки группы | Group settings |
| Тултип добавления задачи | Добавить задачу | Add task |
| Тултип настроек доски | Настройки доски | Board settings |
| Тултип создания доски | Создать доску | Create board |

### Popup настроек доски

| Элемент | Русский | English |
|---------|---------|---------|
| Заголовок | Настройки доски | Board Settings |
| Метка «Название» | Название | Title |
| Метка «Описание» | Описание | Description |
| Удалить доску | Удалить доску | Delete board |
| Подтвердить удаление | Подтвердить удаление | Confirm deletion |
| Нет | Нет | No |
| Отмена | Отмена | Cancel |
| Сохранить | Сохранить | Save |

### Popup настроек группы

| Элемент | Русский | English |
|---------|---------|---------|
| Заголовок | Настройки: {название группы} | Settings: {group name} |
| WIP-лимит | WIP-лимит | WIP limit |
| Плейсхолдер WIP | Без лимита | No limit |
| Хранить завершённые | Хранить завершённые (дней) | Keep completed (days) |
| Отмена | Отмена | Cancel |
| Сохранить | Сохранить | Save |

### Тост удаления

| Элемент | Русский | English |
|---------|---------|---------|
| Текст | Удалено: {имя} | Deleted: {name} |
| Таймер | {n}с | {n}s |
| Кнопка отмены | Отменить | Undo |

### Настройки плагина

| Элемент | Русский | English |
|---------|---------|---------|
| Язык (название) | Язык | Language |
| Язык (описание) | Язык интерфейса плагина | Plugin interface language |
| Авто | Авто (Obsidian) | Auto (Obsidian) |
| English | English | English |
| Русский | Русский | Русский |
| Приоритет (название) | Приоритет по умолчанию | Default priority |
| Приоритет (описание) | Приоритет, назначаемый новым задачам | Priority assigned to new tasks |

### Прочее

| Элемент | Русский | English |
|---------|---------|---------|
| Фоллбэк имени задачи | Задача | Task |
| Дефолт новой доски | Новая доска | New board |
| Дефолт первой доски | Мой проект | My Project |

---

# Часть 2: Техническая

## Архитектура

Собственная i18n-система на Svelte stores, без внешних зависимостей. Реактивный store `t` содержит функцию перевода `(key) => string`. При смене языка store обновляется, и все подписанные Svelte-компоненты перерисовываются автоматически через `$t('key')`.

---

## Новые файлы

```
src/i18n/
  types.ts      — типы: Locale, LanguageSetting, TranslationKey, Translations
  en.ts         — английский словарь
  ru.ts         — русский словарь (текущие строки, вынесенные из компонентов)
  index.ts      — locale store, t derived store, groupLabels derived store,
                  detectLocale(), setLocale()
```

---

## Типы (`src/i18n/types.ts`)

```typescript
export type Locale = 'en' | 'ru';
export type LanguageSetting = 'auto' | Locale;

export type TranslationKey =
  | 'group.backlog' | 'group.focus' | 'group.inProgress'
  | 'group.orgIntentions' | 'group.delegated' | 'group.completed'
  | 'board.newBoard' | 'board.myProject'
  | 'settings.language' | 'settings.languageDesc'
  | 'settings.langAuto' | 'settings.langEn' | 'settings.langRu'
  | 'settings.defaultPriority' | 'settings.defaultPriorityDesc'
  | 'priority.low' | 'priority.medium' | 'priority.high'
  | 'status.new' | 'status.inProgress' | 'status.waiting' | 'status.completed'
  | 'modal.editTask' | 'modal.newTask'
  | 'taskCard.deleteTask'
  | 'boardSettings.heading' | 'boardSettings.title' | 'boardSettings.description'
  | 'boardSettings.deleteBoard' | 'boardSettings.confirmDelete'
  | 'boardSettings.no' | 'boardSettings.cancel' | 'boardSettings.save'
  | 'groupSettings.heading' | 'groupSettings.wipLimit' | 'groupSettings.wipPlaceholder'
  | 'groupSettings.retentionLabel' | 'groupSettings.cancel' | 'groupSettings.save'
  | 'groupHeader.settings' | 'groupHeader.addTask'
  | 'boardHeader.settings' | 'boardHeader.createBoard'
  | 'form.whatLabel' | 'form.whatPlaceholder'
  | 'form.whyLabel' | 'form.whyPlaceholder'
  | 'form.whoLabel' | 'form.whoPlaceholder'
  | 'form.whenLabel' | 'form.priorityLabel' | 'form.statusLabel'
  | 'form.createdAt' | 'form.completedAt'
  | 'form.delete' | 'form.save'
  | 'emptyState.backlog' | 'emptyState.focus' | 'emptyState.inProgress'
  | 'emptyState.orgIntentions' | 'emptyState.delegated' | 'emptyState.completed'
  | 'toast.deleted' | 'toast.seconds' | 'toast.undo'
  | 'fallback.task';

export type Translations = Record<TranslationKey, string>;
```

`TranslationKey` — строковый union, гарантирующий типобезопасность: нельзя использовать несуществующий ключ.

---

## Ядро (`src/i18n/index.ts`)

```typescript
import { writable, derived } from 'svelte/store';
import type { Locale, LanguageSetting, TranslationKey, Translations } from './types';
import type { GroupId } from '../data/types';
import { ru } from './ru';
import { en } from './en';

const dictionaries: Record<Locale, Translations> = { en, ru };

export const locale = writable<Locale>('en');

export const t = derived(locale, ($locale) => {
  const dict = dictionaries[$locale];
  return (key: TranslationKey): string => dict[key] ?? key;
});

export const groupLabels = derived(locale, ($locale) => {
  const dict = dictionaries[$locale];
  return {
    backlog: dict['group.backlog'],
    focus: dict['group.focus'],
    inProgress: dict['group.inProgress'],
    orgIntentions: dict['group.orgIntentions'],
    delegated: dict['group.delegated'],
    completed: dict['group.completed'],
  } as Record<GroupId, string>;
});

export function detectLocale(setting: LanguageSetting): Locale {
  if (setting !== 'auto') return setting;
  const obsLocale = window.moment?.locale?.() ?? 'en';
  return obsLocale.startsWith('ru') ? 'ru' : 'en';
}

export function setLocale(setting: LanguageSetting): void {
  locale.set(detectLocale(setting));
}
```

**Ключевые решения:**

- `locale` — writable store, содержит разрешённую локаль (`'en'` или `'ru'`, никогда `'auto'`)
- `t` — derived store, при подписке возвращает функцию перевода. В Svelte-компонентах используется как `$t('key')`
- `groupLabels` — derived store, возвращает `Record<GroupId, string>`. Заменяет статический `GROUP_LABELS` из `types.ts`
- `detectLocale()` — определяет локаль из `moment.locale()` (API Obsidian). Для русского — `'ru'`, для всех остальных — `'en'`
- `setLocale()` — вызывается при загрузке плагина и при смене настройки Language

---

## Словари (`src/i18n/en.ts`, `src/i18n/ru.ts`)

Каждый словарь — объект типа `Translations` (~66 ключей). Формат:

```typescript
import type { Translations } from './types';

export const en: Translations = {
  'group.backlog': 'Backlog',
  'group.focus': 'Focus',
  // ... все ключи из таблиц переводов (Часть 1)
};
```

Русский словарь содержит текущие строки, вынесенные из компонентов. Английский — их переводы из таблиц в Части 1.

---

## Изменения в типах данных

### `src/data/types.ts`

```diff
+ import type { LanguageSetting } from '../i18n/types';

- export const GROUP_LABELS: Record<GroupId, string> = { ... };
  // Удаляется — заменяется на groupLabels derived store из i18n

  export interface Settings {
    defaultPriority: Priority;
+   language: LanguageSetting;
  }
```

### `src/data/defaults.ts`

```diff
  export const DEFAULT_SETTINGS: Settings = {
    defaultPriority: 'medium',
+   language: 'auto',
  };
```

Дефолтное название при `createDefaultBoard()` и в `DEFAULT_DATA` остаётся на русском (текущее поведение для обратной совместимости). При создании новой доски через UI (`dataStore.createBoard()`) название берётся из текущей локали через `get(t)('board.newBoard')`.

### `src/data/migration.ts`

Добавляется миграция `version 1 → 2`:

```typescript
if (version < 2) {
  raw.settings.language = raw.settings.language ?? 'auto';
  raw.version = 2;
}
```

`DEFAULT_DATA.version` обновляется с `1` на `2`.

---

## Инициализация (`src/main.ts`)

```diff
+ import { setLocale } from './i18n';

  async onload(): Promise<void> {
    await this.loadPluginData();
+   setLocale(this.data.settings.language);
    // ... остальное без изменений
  }
```

`setLocale()` вызывается сразу после загрузки данных, до инициализации stores и view. Это гарантирует, что при первом рендере UI уже на правильном языке.

---

## Настройки плагина (`src/settings.ts`)

Settings Tab — императивный (Obsidian API, не Svelte), поэтому используется `get(t)` вместо `$t`:

```typescript
import { get } from 'svelte/store';
import { t, setLocale } from './i18n';
import type { LanguageSetting } from './i18n/types';

display(): void {
  const tr = get(t);
  containerEl.empty();

  // Первый параметр — Language
  new Setting(containerEl)
    .setName(tr('settings.language'))
    .setDesc(tr('settings.languageDesc'))
    .addDropdown(dd => dd
      .addOptions({
        auto: tr('settings.langAuto'),
        en: tr('settings.langEn'),
        ru: tr('settings.langRu'),
      })
      .setValue(this.plugin.data.settings.language)
      .onChange(async (value) => {
        this.plugin.data.settings.language = value as LanguageSetting;
        setLocale(value as LanguageSetting);
        dataStore.set(this.plugin.data);
        await this.plugin.savePluginData();
        this.display(); // перерисовать настройки на новом языке
      })
    );

  // Второй параметр — Default Priority
  new Setting(containerEl)
    .setName(tr('settings.defaultPriority'))
    .setDesc(tr('settings.defaultPriorityDesc'))
    .addDropdown(dd => dd
      .addOptions({
        low: tr('priority.low'),
        medium: tr('priority.medium'),
        high: tr('priority.high'),
      })
      .setValue(this.plugin.data.settings.defaultPriority)
      .onChange(async (value) => { ... })
    );
}
```

При смене языка вызывается `this.display()` — перерисовка страницы настроек на новом языке.

---

## Модальное окно (`src/modals/TaskModal.ts`)

Императивный TypeScript (не Svelte), аналогично Settings Tab:

```diff
+ import { get } from 'svelte/store';
+ import { t } from '../i18n';

  onOpen(): void {
+   const tr = get(t);
-   this.titleEl.setText(this.task ? 'Редактировать задачу' : 'Новая задача');
+   this.titleEl.setText(this.task ? tr('modal.editTask') : tr('modal.newTask'));
  }
```

---

## Svelte-компоненты — паттерн замены

Единый паттерн для всех `.svelte` файлов:

```svelte
<script lang="ts">
  import { t } from '../i18n';           // для $t('key')
  import { groupLabels } from '../i18n'; // для $groupLabels[groupId] (где нужно)
</script>

<!-- Было: -->
<button title="Добавить задачу">+</button>
<option value="low">Низкий</option>

<!-- Стало: -->
<button title={$t('groupHeader.addTask')}>+</button>
<option value="low">{$t('priority.low')}</option>
```

### Изменения по файлам

#### `TaskCard.svelte`
- `title="Удалить задачу"` → `title={$t('taskCard.deleteTask')}`

#### `BoardHeader.svelte`
- `title="Настройки доски"` → `title={$t('boardHeader.settings')}`
- `title="Создать доску"` → `title={$t('boardHeader.createBoard')}`

#### `GroupHeader.svelte`
- Импорт `GROUP_LABELS` → импорт `groupLabels` из `../i18n`
- `{GROUP_LABELS[groupId]}` → `{$groupLabels[groupId]}`
- `title="Настройки группы"` → `title={$t('groupHeader.settings')}`
- `title="Добавить задачу"` → `title={$t('groupHeader.addTask')}`

#### `CollapsibleGroup.svelte`
- Импорт `GROUP_LABELS` → импорт `groupLabels` из `../i18n`
- `{GROUP_LABELS[groupId]}` → `{$groupLabels[groupId]}`
- `title="Настройки группы"` → `title={$t('groupHeader.settings')}`
- `title="Добавить задачу"` → `title={$t('groupHeader.addTask')}`

#### `EmptyState.svelte`
- Удаляется локальный `hints: Record<GroupId, string>`
- Используется `$t(`emptyState.${groupId}` as TranslationKey)`

#### `TaskFormContent.svelte`
- Все 14 строк: метки, плейсхолдеры, опции `<select>`, кнопки
- Пример: `<label>Что нужно сделать *</label>` → `<label>{$t('form.whatLabel')}</label>`

#### `BoardSettingsPopup.svelte`
- Все 8 строк: заголовок, метки полей, кнопки

#### `GroupSettingsPopup.svelte`
- Импорт `GROUP_LABELS` → импорт `groupLabels`
- Все 5 строк: заголовок с `$groupLabels[groupId]`, метки, кнопки

#### `DeleteToast.svelte`
- `Удалено: {taskName}` → `{$t('toast.deleted')}: {taskName}`
- `{remaining}с` → `{remaining}{$t('toast.seconds')}`
- `Отменить` → `{$t('toast.undo')}`

#### `BoardLayout.svelte`
- `'Задача'` (фоллбэк в шаблоне) → `$t('fallback.task')`

#### `dataStore.ts`
- В функции `createBoard()`: `createDefaultBoard()` → `createDefaultBoard(get(t)('board.newBoard'))`

---

## Удаление GROUP_LABELS

`GROUP_LABELS` из `src/data/types.ts` удаляется полностью. Все 3 файла, которые его импортировали, переходят на `groupLabels` derived store из `src/i18n/index.ts`:

| Файл | Было | Стало |
|------|------|-------|
| `GroupHeader.svelte` | `import { GROUP_LABELS } from '../data/types'` | `import { groupLabels } from '../i18n'` |
| `CollapsibleGroup.svelte` | `import { GROUP_LABELS } from '../data/types'` | `import { groupLabels } from '../i18n'` |
| `GroupSettingsPopup.svelte` | `import { GROUP_LABELS } from '../data/types'` | `import { groupLabels } from '../i18n'` |

---

## Порядок реализации

| Фаза | Что делаем | Файлы |
|------|-----------|-------|
| 1 | i18n ядро | `src/i18n/types.ts`, `en.ts`, `ru.ts`, `index.ts` |
| 2 | Типы и данные | `src/data/types.ts`, `defaults.ts`, `migration.ts` |
| 3 | Инициализация | `src/main.ts` |
| 4 | Настройки | `src/settings.ts` |
| 5 | Императивный TS | `src/modals/TaskModal.ts`, `src/stores/dataStore.ts` |
| 6 | Svelte-компоненты | 10 файлов `.svelte` |
| 7 | Сборка и проверка | `npm run build`, тест обеих локалей |

---

## Структура проекта после изменений

```
src/
├── data/
│   ├── types.ts             — убран GROUP_LABELS, добавлено language в Settings
│   ├── defaults.ts          — добавлено language: 'auto' в DEFAULT_SETTINGS
│   ├── migration.ts         — миграция v1→v2
│   └── cleanup.ts           — без изменений
├── i18n/                    — НОВЫЙ каталог
│   ├── types.ts             — типы i18n
│   ├── en.ts                — английский словарь
│   ├── ru.ts                — русский словарь
│   └── index.ts             — stores и утилиты
├── stores/
│   ├── dataStore.ts         — createBoard() использует t store
│   ├── uiStore.ts           — без изменений
│   └── pluginStore.ts       — без изменений
├── ui/
│   ├── App.svelte           — без изменений
│   ├── BoardHeader.svelte   — $t для тултипов
│   ├── BoardLayout.svelte   — $t для фоллбэка
│   ├── BoardSettingsPopup.svelte — $t для всех строк
│   ├── CollapsibleGroup.svelte   — $groupLabels + $t
│   ├── DeleteToast.svelte   — $t для текста/кнопки
│   ├── EmptyState.svelte    — $t для подсказок
│   ├── GroupHeader.svelte   — $groupLabels + $t
│   ├── GroupSettingsPopup.svelte — $groupLabels + $t
│   ├── TaskCard.svelte      — $t для тултипа
│   ├── TaskFormContent.svelte — $t для всех строк
│   ├── TaskGroup.svelte     — без изменений
│   └── useSortable.ts       — без изменений
├── modals/
│   └── TaskModal.ts         — get(t) для заголовка
├── settings.ts              — get(t) + языковой dropdown
├── main.ts                  — setLocale() при загрузке
├── view.ts                  — без изменений
└── styles.css               — без изменений
```

---

# Часть 3: Тестовые сценарии

## Предусловия

- Obsidian запущен
- Плагин TaskMaster установлен и включён
- На доске есть хотя бы одна задача с заполненными полями (что, зачем, кто, дедлайн)

---

## TC-1: Сборка

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | `npm run build` | Сборка завершается без ошибок (допускаются a11y warnings) |
| 2 | Скопировать `main.js`, `manifest.json`, `styles.css` в vault | Файлы на месте |
| 3 | Перезагрузить Obsidian (Ctrl+R) | Плагин загружается без ошибок в консоли |

---

## TC-2: Автоопределение языка (Auto)

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Obsidian → Settings → General → Language → **Русский** | Obsidian переключается на русский |
| 2 | Перезагрузить Obsidian | — |
| 3 | Открыть вкладку TaskMaster | Весь интерфейс на русском: названия групп (Бэклог, Фокус, В работе…), тултипы, подсказки пустых групп |
| 4 | Obsidian → Settings → General → Language → **English** | Obsidian переключается на английский |
| 5 | Перезагрузить Obsidian | — |
| 6 | Открыть вкладку TaskMaster | Весь интерфейс на английском: Backlog, Focus, In Progress… |

---

## TC-3: Ручное переключение языка

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Settings → TaskMaster → Language → **English** | — |
| 2 | Перейти на вкладку TaskMaster | Интерфейс на английском |
| 3 | Settings → TaskMaster → Language → **Русский** | — |
| 4 | Перейти на вкладку TaskMaster | Интерфейс мгновенно переключился на русский (без перезагрузки) |
| 5 | Settings → TaskMaster → Language → **Auto (Obsidian)** | Язык определяется по настройке Obsidian |

---

## TC-4: Настройки плагина локализованы

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Установить Language → English | — |
| 2 | Открыть Settings → TaskMaster | «Language» / «Plugin interface language» / «Default priority» / «Priority assigned to new tasks» / «Low/Medium/High» |
| 3 | Переключить Language → Русский | Страница настроек перерисовалась: «Язык» / «Язык интерфейса плагина» / «Приоритет по умолчанию» / «Приоритет, назначаемый новым задачам» / «Низкий/Средний/Высокий» |

---

## TC-5: Названия групп

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Установить English | — |
| 2 | Открыть доску | Backlog, Focus, In Progress, Org Intentions, Delegated, Completed |
| 3 | Переключить на Русский | Бэклог, Фокус, В работе, Орг. намерения, Делегировано, Завершённые |

---

## TC-6: Подсказки пустых групп

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Создать новую доску (все группы пусты) | — |
| 2 | Развернуть группу Backlog | Подсказка на текущем языке (EN: «Future tasks. Put here everything…» / RU: «Задачи на будущее…») |
| 3 | Проверить Focus, In Progress, Org Intentions, Delegated, Completed | Каждая группа показывает свою подсказку на текущем языке |

---

## TC-7: Форма создания задачи

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Установить English | — |
| 2 | Нажать «+» в группе Focus | Открывается модалка с заголовком «New Task» |
| 3 | Проверить метки полей | «What needs to be done *», «Why», «Who», «When», «Priority», «Status» |
| 4 | Проверить плейсхолдеры | «Task description», «Task objective», «Assignee» |
| 5 | Проверить опции Priority | Low, Medium, High |
| 6 | Проверить опции Status | New, In Progress, Waiting, Completed |
| 7 | Проверить кнопку | «Save» |
| 8 | Переключить на Русский, открыть заново | Все метки, плейсхолдеры, опции, кнопки — на русском |

---

## TC-8: Форма редактирования задачи

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Кликнуть на существующую задачу | Модалка с заголовком «Edit Task» (EN) / «Редактировать задачу» (RU) |
| 2 | Проверить мета-информацию | «Created: …» (EN) / «Создана: …» (RU) |
| 3 | Если задача завершена | «Completed: …» (EN) / «Завершена: …» (RU) |
| 4 | Проверить кнопки | «Delete» + «Save» (EN) / «Удалить» + «Сохранить» (RU) |

---

## TC-9: Тултипы

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Установить English | — |
| 2 | Навести на «+» в группе | Тултип: «Add task» |
| 3 | Навести на шестерёнку в группе | Тултип: «Group settings» |
| 4 | Навести на шестерёнку в хедере доски | Тултип: «Board settings» |
| 5 | Навести на «+» в хедере доски | Тултип: «Create board» |
| 6 | Навести на «✕» на карточке | Тултип: «Delete task» |
| 7 | Переключить на Русский | Тултипы: «Добавить задачу», «Настройки группы», «Настройки доски», «Создать доску», «Удалить задачу» |

---

## TC-10: Popup настроек доски

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Установить English | — |
| 2 | Нажать шестерёнку в хедере доски | Popup: «Board Settings», «Title», «Description», «Cancel», «Save» |
| 3 | Если доска не единственная | Кнопка «Delete board» → по нажатию «Confirm deletion» + «No» |
| 4 | Переключить на Русский, открыть заново | «Настройки доски», «Название», «Описание», «Отмена», «Сохранить», «Удалить доску» → «Подтвердить удаление» + «Нет» |

---

## TC-11: Popup настроек группы

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Установить English | — |
| 2 | Нажать шестерёнку в группе Focus | Popup: «Settings: Focus», «WIP limit», placeholder «No limit», «Cancel», «Save» |
| 3 | Нажать шестерёнку в группе Completed | Дополнительное поле: «Keep completed (days)» |
| 4 | Переключить на Русский, открыть заново | «Настройки: Фокус», «WIP-лимит», «Без лимита», «Отмена», «Сохранить» |

---

## TC-12: Тост удаления

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Установить English | — |
| 2 | Удалить задачу (нажать «✕» на карточке) | Тост: «Deleted: {название задачи}», таймер «7s…6s…», кнопка «Undo» |
| 3 | Переключить на Русский, удалить задачу | Тост: «Удалено: {название}», таймер «7с…6с…», кнопка «Отменить» |
| 4 | Нажать «Undo» / «Отменить» | Задача восстанавливается на прежнее место |

---

## TC-13: Создание новой доски

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Установить English | — |
| 2 | Нажать «+» в хедере доски | Создаётся доска с названием «New board» |
| 3 | Переключить на Русский | — |
| 4 | Нажать «+» в хедере доски | Создаётся доска с названием «Новая доска» |

---

## TC-14: Пользовательские данные не переводятся

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Установить Русский | — |
| 2 | Создать задачу: «Купить молоко», исполнитель «Вася» | Задача создана |
| 3 | Переключить на English | — |
| 4 | Открыть ту же задачу | Текст «Купить молоко», исполнитель «Вася» — без изменений |
| 5 | Название доски | Остаётся на языке, на котором было введено |

---

## TC-15: Миграция данных v1 → v2

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Взять `data.json` плагина от версии без i18n (version: 1) | — |
| 2 | Загрузить плагин с новой версией | — |
| 3 | Проверить `data.json` | `version: 2`, `settings.language: "auto"` |
| 4 | Все существующие доски и задачи | Сохранены без изменений |

---

## TC-16: Неизменяемые элементы

| Шаг | Действие | Ожидаемый результат |
|-----|----------|---------------------|
| 1 | Проверить название вкладки | «TaskMaster» — одинаково на обоих языках |
| 2 | Проверить ribbon-иконку (тултип) | «TaskMaster» — одинаково |
| 3 | Открыть Command Palette, ввести «taskmaster» | Команда «Open TaskMaster board» — на английском в обоих локалях |
